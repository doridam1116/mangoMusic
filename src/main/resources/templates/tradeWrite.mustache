{{>layouts/sidebar}}
<link rel="stylesheet" href="css/notice_wr.css" />
<link rel="stylesheet" href="css/tradeDetail.css" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<main>
    <nav class="navbar sticky-top mb-3" id="navbar-mypage">
        <div class="d-flex align-items-center justify-content-between" id="d-flex-mypage">
            <div class="d-flex"></div>
            <!-- <i class="fa-solid fa-chevron-left chevrons"></i><i class="fa-solid fa-chevron-right chevrons"></i> -->
        </div>

        <div class="d-flex align-items-center" id="rightnav">
            <div style="margin-right: 1rem">
            </div>
            {{#loginUser}}
                <div class="dropdown" id="myPageDropDown">
                    <button class="btn btn-dark dropdown-toggle" type="button" id="dropdownMenuButton1"
                            data-bs-toggle="dropdown" aria-expanded="false" style="border-radius: 25px;">
                        <!-- 유저 이미지 -->
                        {{#loginUser.userFilename}}
                            <img src="{{loginUser.userFilename}}"
                                 style="width: 30px; height: 30px; border-radius: 50%" class="dropdown-pic"/>
                        {{/loginUser.userFilename}}
                        {{^loginUser.userFilename}}
                            <img src="../img/abstract-user-flat-3.svg"
                                 style="width: 30px; height: 30px; border-radius: 50%" class="dropdown-pic"/>
                        {{/loginUser.userFilename}}
                        <!-- 유저이름 -->
                        &nbsp;&nbsp;{{userName}}&nbsp;&nbsp;
                    </button>
                    <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="dropdownMenuButton1">
                        {{#loginUser.userType}}
                            <li><a class="dropdown-item" href="/admin">관리자페이지</a></li>
                        {{/loginUser.userType}}
                        {{^loginUser.userType}}
                            <li><a class="dropdown-item" href="/mypage">마이페이지</a></li>
                        {{/loginUser.userType}}
                        <li><a class="dropdown-item" href="/logout">로그아웃</a></li>
                    </ul>
                </div>
            {{/loginUser}}
            {{^loginUser}}
                <button type="button" onclick="location.href='/login'" class="btn btn-dark dropdown-toggle2" >로그인</button>
            {{/loginUser}}
        </div>
    </nav>
    <div id="main-all">
        <div class="main-header">
            <h2>거래소</h2>
            <hr>
        </div>
        <div class="main-body">
            <form action="/tradeWrite" method="post" onsubmit="return validateForm()">
                <div class="writer">
                    <div class="title" style="margin-bottom: 20px">
                        <label>제목</label> <br>
                        <input type="text" class="title_text" name="tradeSubject" placeholder="제목을 입력해주세요.">
                    </div>
                    <div>
                        <label>가격</label><br>
                        <input type="text" class="tradePrice-input" name="tradePrice" placeholder="가격을 입력 해 주세요." onkeyup="priceOnkey();">
                        <div>
                            <label for="file">
                                <div class="upload-btn" style="border : 1px solid #ccc; padding: 5px;">음악찾기</div>
                            </label>
                            <input type="file" name="file" style="display: none" id="file">
                        <button type="button" class="upload-btn" id="upload-btn-id" onclick="fn_submit();">업로드</button><small style="margin-left: 10px">* 파일선택 후 업로드해야 정상적으로 파일첨부가 됩니다.</small>
                        </div>

                    </div>
                    <div class="content">
                        <label>내용</label> <br>
                        <textarea class="tradeWriteContent" name="tradeContent" rows="30" cols="150" placeholder="내용을 입력해주세요."></textarea>
                    </div>
                    <div class="div_btn">
                        <input type="submit" id="enter" class="button" value="등록">
                        <input type="reset" class="button" value="취소">
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script>

        function validateForm() {
            var title = document.forms["myForm"]["tradeSubject"].value.trim();
            var content = document.forms["myForm"]["tradeContent"].value.trim();
            var price = document.forms["myForm"]["tradePrice"].value.trim();
            var titleRegex = /^\S/;
            var contentRegex = /^\S/;
            var priceRegex = /^\S/;
            if (title == "" || content == "" || price == "" || !titleRegex.test(title) || !contentRegex.test(content) || !priceRegex.test(price)) {
                alert("제목과 내용 및 가격을 모두 입력해주세요.");
                return false;
            }
        }

        function priceOnkey(){
            var str = $('.tradePrice-input').val();
            let check = /^[0-9]+$/;
            if (!check.test(str)) {
                alert("숫자만 입력 가능합니다.");
                var a = "";
                $('.tradePrice-input').val(a);
            }
        }
    </script>
</main>
{{>layouts/footer}}
